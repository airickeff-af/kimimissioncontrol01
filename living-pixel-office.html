<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mission Control - Isometric Pixel Office v5</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --bg: #0f0f1a;
            --panel: #f4e4c1;
            --neon-cyan: #00ffff;
            --neon-pink: #ff6b9d;
            --neon-green: #51cf66;
            --neon-yellow: #fcc419;
            --neon-purple: #a855f7;
            --neon-orange: #ff922b;
            --iso-bg: #1a1a2e;
        }
        
        body {
            font-family: 'VT323', monospace;
            background: var(--bg);
            color: var(--panel);
            min-height: 100vh;
            overflow: hidden;
        }
        
        .container {
            display: grid;
            grid-template-columns: 1fr 420px;
            height: 100vh;
        }
        
        .office-area {
            position: relative;
            background: linear-gradient(180deg, #0d0d1a 0%, #1a1a2e 50%, #16213e 100%);
            overflow: hidden;
        }
        
        #office-canvas {
            width: 100%;
            height: 100%;
            image-rendering: pixelated;
        }
        
        .office-header {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            background: rgba(0,0,0,0.9);
            padding: 12px 24px;
            border-radius: 12px;
            border: 2px solid var(--neon-cyan);
            z-index: 10;
            box-shadow: 0 0 20px rgba(0,255,255,0.3);
        }
        
        .office-header h1 {
            font-family: 'Press Start 2P', cursive;
            font-size: 0.7rem;
            color: var(--neon-cyan);
            margin-bottom: 8px;
            text-shadow: 0 0 10px var(--neon-cyan);
        }
        
        .last-updated {
            font-size: 0.75rem;
            color: #888;
        }
        
        .standup-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 12px 24px;
            background: linear-gradient(135deg, var(--neon-pink), #c92a2a);
            border: 2px solid var(--neon-pink);
            border-radius: 8px;
            color: white;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.6rem;
            cursor: pointer;
            z-index: 20;
            box-shadow: 0 0 20px rgba(255,107,157,0.4);
            transition: all 0.3s;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 20px rgba(255,107,157,0.4); }
            50% { box-shadow: 0 0 40px rgba(255,107,157,0.7); }
        }
        
        .standup-btn:hover { transform: scale(1.05); }
        .standup-btn:disabled {
            background: #444;
            border-color: #666;
            animation: none;
            cursor: not-allowed;
        }
        
        .meeting-status {
            position: absolute;
            top: 60px;
            right: 10px;
            padding: 8px 16px;
            background: rgba(0,0,0,0.9);
            border: 1px solid var(--neon-cyan);
            border-radius: 6px;
            font-size: 0.8rem;
            color: var(--neon-cyan);
            z-index: 20;
            display: none;
        }
        .meeting-status.active { display: block; animation: blink 1s infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        
        .speech-bubble {
            position: absolute;
            background: rgba(0, 212, 255, 0.95);
            color: #000;
            padding: 8px 12px;
            border-radius: 12px;
            font-size: 11px;
            max-width: 180px;
            z-index: 100;
            font-family: 'VT323', monospace;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            pointer-events: none;
        }
        .speech-bubble::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 20px;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 8px solid rgba(0, 212, 255, 0.95);
        }
        
        .sidebar {
            background: rgba(0,0,0,0.95);
            border-left: 3px solid var(--neon-cyan);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .sidebar-header {
            padding: 15px;
            background: linear-gradient(90deg, rgba(0,255,255,0.1), transparent);
            border-bottom: 2px solid var(--neon-cyan);
        }
        .sidebar-header h2 {
            font-family: 'Press Start 2P', cursive;
            font-size: 0.65rem;
            color: var(--neon-cyan);
        }
        .tabs {
            display: flex;
            flex-wrap: wrap;
            border-bottom: 1px solid var(--neon-cyan);
            background: rgba(0,0,0,0.5);
        }
        .tab {
            flex: 1;
            min-width: 80px;
            padding: 10px 5px;
            border: none;
            background: transparent;
            color: var(--panel);
            font-family: 'VT323', monospace;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }
        .tab:hover { background: rgba(0,255,255,0.1); }
        .tab.active {
            background: rgba(0,255,255,0.2);
            color: var(--neon-cyan);
            border-bottom: 2px solid var(--neon-cyan);
        }
        .tab-content {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            display: none;
        }
        .tab-content.active { display: block; }
        
        .activity-item {
            padding: 10px;
            margin-bottom: 8px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            border-left: 3px solid var(--neon-cyan);
            font-size: 0.85rem;
            animation: slideIn 0.3s ease;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }
        .activity-time { font-size: 0.7rem; color: #666; display: block; margin-bottom: 3px; }
        .activity-text { color: var(--panel); }
        .activity-agents { color: var(--neon-cyan); font-weight: bold; }
        
        .agent-status-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            margin-bottom: 5px;
            background: rgba(255,255,255,0.03);
            border-radius: 5px;
            font-size: 0.8rem;
            transition: all 0.2s;
        }
        .agent-status-item:hover { background: rgba(0,255,255,0.1); }
        .agent-emoji { font-size: 1.2rem; }
        .agent-info { flex: 1; }
        .agent-name { font-weight: bold; }
        .agent-task { font-size: 0.75rem; color: #888; }
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--neon-green);
        }
        .status-dot.busy { background: var(--neon-yellow); }
        .status-dot.meeting { background: var(--neon-pink); animation: blink 1s infinite; }
        .status-dot.resting { background: #666; }
        
        .meeting-log {
            background: rgba(255,107,157,0.1);
            border: 1px solid var(--neon-pink);
            border-radius: 8px;
            padding: 10px;
            margin-top: 10px;
            font-size: 0.8rem;
        }
        .meeting-log h4 { color: var(--neon-pink); margin-bottom: 8px; }
        .meeting-topic { padding: 5px 0; border-bottom: 1px solid rgba(255,107,157,0.2); }
    </style>
</head>
<body>
    <div class="container">
        <div class="office-area">
            <canvas id="office-canvas"></canvas>
            <div class="office-header">
                <h1>üè¢ MISSION CONTROL HQ</h1>
                <div class="last-updated" id="last-updated">Last updated: Just now</div>
            </div>
            
            <button class="standup-btn" id="standup-btn" onclick="startStandup()">
                üé§ CALL STANDUP
            </button>
            
            <div class="meeting-status" id="meeting-status">
                üé§ STANDUP IN PROGRESS
            </div>
        </div>
        
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>üìä COMMAND CENTER</h2>
            </div>
            
            <div class="tabs">
                <button class="tab active" onclick="switchTab('activity')">üì° Activity</button>
                <button class="tab" onclick="switchTab('agents')">ü§ñ Agents</button>
                <button class="tab" onclick="switchTab('meeting')">üé§ Meeting</button>
            </div>
            
            <div id="activity-tab" class="tab-content active">
                <div id="activity-feed">
                    <div class="activity-item">
                        <span class="activity-time">21:18:00</span>
                        <span class="activity-text"><span class="activity-agents">Nexus</span> updated office v5 with 20 agents</span>
                    </div>
                    <div class="activity-item">
                        <span class="activity-time">21:09:00</span>
                        <span class="activity-text"><span class="activity-agents">Nexus</span> updated pixel office v4</span>
                    </div>
                </div>
            </div>
            
            <div id="agents-tab" class="tab-content">
                <h3 style="color: var(--neon-cyan); margin-bottom: 15px; font-size: 0.9rem;">ü§ñ AGENT STATUS (20 TOTAL)</h3>
                <div id="agent-list"></div>
            </div>
            
            <div id="meeting-tab" class="tab-content">
                <h3 style="color: var(--neon-pink); margin-bottom: 15px; font-size: 0.9rem;">üé§ STANDUP MEETING</h3>
                <p style="font-size: 0.85rem; color: #888; margin-bottom: 15px;">Click "CALL STANDUP" to gather all 20 agents for a team meeting.</p>
                <div class="meeting-log" id="meeting-log" style="display: none;">
                    <h4>üìã Meeting Topics</h4>
                    <div id="meeting-topics"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // All 20 agents with fixed desk positions
        // EricF and Nexus at top (command balcony)
        // 3 Forge, 3 Code in dev area
        // Others in their departments
        const agents = [
            // EXECUTIVE BALCONY (Top - watching over everyone)
            { id: 'ericf', name: 'EricF', emoji: 'üë®‚Äçüíª', role: 'Commander', x: 300, y: 100, color: '#ff2a6d', status: 'working', activity: 'Strategic oversight', desk: 'Command Desk A', dept: 'Executive' },
            { id: 'nexus', name: 'Nexus', emoji: 'ü§ñ', role: 'Orchestrator', x: 500, y: 100, color: '#ff2a6d', status: 'working', activity: 'Monitoring systems', desk: 'Command Desk B', dept: 'Executive' },
            
            // DEV TEAM - 3 Forge, 3 Code (Left side)
            { id: 'forge1', name: 'Forge-1', emoji: 'üî®', role: 'UI Lead', x: 100, y: 250, color: '#ff922b', status: 'working', activity: 'Component library', desk: 'Forge Station 1', dept: 'Dev' },
            { id: 'forge2', name: 'Forge-2', emoji: 'üî®', role: 'UI Dev', x: 200, y: 250, color: '#ff922b', status: 'working', activity: 'Mobile responsive', desk: 'Forge Station 2', dept: 'Dev' },
            { id: 'forge3', name: 'Forge-3', emoji: 'üî®', role: 'UI Dev', x: 300, y: 250, color: '#ff922b', status: 'working', activity: 'Animations', desk: 'Forge Station 3', dept: 'Dev' },
            { id: 'code1', name: 'Code-1', emoji: 'üíª', role: 'Backend Lead', x: 100, y: 350, color: '#51cf66', status: 'busy', activity: 'API endpoints', desk: 'Code Terminal 1', dept: 'Dev' },
            { id: 'code2', name: 'Code-2', emoji: 'üíª', role: 'Backend Dev', x: 200, y: 350, color: '#51cf66', status: 'working', activity: 'Database', desk: 'Code Terminal 2', dept: 'Dev' },
            { id: 'code3', name: 'Code-3', emoji: 'üíª', role: 'Backend Dev', x: 300, y: 350, color: '#51cf66', status: 'working', activity: 'Testing', desk: 'Code Terminal 3', dept: 'Dev' },
            
            // DESIGN TEAM (Near dev)
            { id: 'pixel1', name: 'Pixel-1', emoji: 'üé®', role: 'Design Lead', x: 450, y: 250, color: '#a855f7', status: 'working', activity: 'Avatar design', desk: 'Design Station 1', dept: 'Design' },
            { id: 'pixel2', name: 'Pixel-2', emoji: 'üé®', role: 'Designer', x: 550, y: 250, color: '#a855f7', status: 'working', activity: 'Style guide', desk: 'Design Station 2', dept: 'Design' },
            { id: 'pixel3', name: 'Pixel-3', emoji: 'üé®', role: 'Designer', x: 650, y: 250, color: '#a855f7', status: 'working', activity: 'Assets', desk: 'Design Station 3', dept: 'Design' },
            
            // CONTENT TEAM (Right side)
            { id: 'glasses', name: 'Glasses', emoji: 'üîç', role: 'Research Lead', x: 750, y: 250, color: '#00ffff', status: 'resting', activity: 'Resting', desk: 'Research Desk', dept: 'Content' },
            { id: 'quill', name: 'Quill', emoji: '‚úçÔ∏è', role: 'Content Lead', x: 850, y: 250, color: '#fcc419', status: 'resting', activity: 'Resting', desk: 'Content Pod', dept: 'Content' },
            
            // GROWTH TEAM (Middle right)
            { id: 'gary', name: 'Gary', emoji: 'üìä', role: 'Marketing Lead', x: 750, y: 350, color: '#ff922b', status: 'resting', activity: 'Resting', desk: 'Marketing Desk', dept: 'Growth' },
            { id: 'larry', name: 'Larry', emoji: 'üì±', role: 'Social Lead', x: 850, y: 350, color: '#51cf66', status: 'resting', activity: 'Resting', desk: 'Social Hub', dept: 'Growth' },
            
            // OPS TEAM (Bottom left)
            { id: 'sentry', name: 'Sentry', emoji: '‚öôÔ∏è', role: 'DevOps Lead', x: 200, y: 500, color: '#00ffff', status: 'working', activity: 'Monitoring', desk: 'Ops Center', dept: 'Ops' },
            { id: 'audit', name: 'Audit', emoji: '‚úÖ', role: 'QA Lead', x: 350, y: 500, color: '#fcc419', status: 'working', activity: 'Code review', desk: 'QA Station', dept: 'Ops' },
            { id: 'cipher', name: 'Cipher', emoji: 'üîí', role: 'Security Lead', x: 500, y: 500, color: '#a855f7', status: 'working', activity: 'Security check', desk: 'Security Post', dept: 'Ops' },
            
            // BUSINESS DEV TEAM (Bottom right)
            { id: 'dealflow', name: 'DealFlow', emoji: 'ü§ù', role: 'BD Lead', x: 700, y: 500, color: '#ff922b', status: 'busy', activity: 'Finding leads', desk: 'BD Desk', dept: 'Business Dev' },
            { id: 'coldcall', name: 'ColdCall', emoji: 'üìû', role: 'Outreach Lead', x: 850, y: 500, color: '#51cf66', status: 'working', activity: 'Prep outreach', desk: 'Outreach Station', dept: 'Business Dev' }
        ];

        // Meeting table position (center of office)
        const meetingTable = { x: 500, y: 350, radius: 120 };
        
        let isStandupActive = false;
        let agentPositions = {};

        const canvas = document.getElementById('office-canvas');
        const ctx = canvas.getContext('2d');
        
        function resizeCanvas() {
            canvas.width = canvas.parentElement.clientWidth;
            canvas.height = canvas.parentElement.clientHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // Isometric projection
        function toIso(x, y) {
            const scale = 0.7;
            const isoX = (x - y) * 0.866 * scale + canvas.width / 2;
            const isoY = (x + y) * 0.5 * scale + 80;
            return { x: isoX, y: isoY };
        }

        function drawOffice() {
            ctx.fillStyle = '#0f0f1a';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw grid floor
            ctx.strokeStyle = 'rgba(0, 255, 255, 0.08)';
            ctx.lineWidth = 1;
            for (let i = -15; i < 25; i++) {
                const start1 = toIso(i * 60, -800);
                const end1 = toIso(i * 60, 800);
                ctx.beginPath();
                ctx.moveTo(start1.x, start1.y);
                ctx.lineTo(end1.x, end1.y);
                ctx.stroke();
                
                const start2 = toIso(-800, i * 60);
                const end2 = toIso(800, i * 60);
                ctx.beginPath();
                ctx.moveTo(start2.x, start2.y);
                ctx.lineTo(end2.x, end2.y);
                ctx.stroke();
            }
            
            // Draw Command Balcony (top - EricF & Nexus)
            drawBalcony();
            
            // Draw Meeting Table (center)
            drawMeetingTable();
            
            // Draw all fixed desks
            agents.forEach(agent => {
                if (!isStandupActive || agent.status !== 'meeting') {
                    drawDesk(agent);
                }
            });
            
            // Draw all agents
            agents.forEach(agent => {
                drawAgent(agent);
            });
            
            // Draw connections if in meeting
            if (isStandupActive) {
                drawMeetingConnections();
            }
        }

        function drawBalcony() {
            // Executive command balcony at top
            const balconyY = 80;
            
            // Balcony floor
            const bl1 = toIso(200, balconyY);
            const bl2 = toIso(600, balconyY);
            const bl3 = toIso(650, balconyY + 50);
            const bl4 = toIso(150, balconyY + 50);
            
            ctx.fillStyle = 'rgba(255, 42, 109, 0.15)';
            ctx.strokeStyle = '#ff2a6d';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(bl1.x, bl1.y);
            ctx.lineTo(bl2.x, bl2.y);
            ctx.lineTo(bl3.x, bl3.y);
            ctx.lineTo(bl4.x, bl4.y);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
            
            // Balcony label
            ctx.fillStyle = '#ff2a6d';
            ctx.font = '10px "Press Start 2P"';
            ctx.textAlign = 'center';
            const centerBalcony = toIso(400, balconyY + 25);
            ctx.fillText('COMMAND BALCONY', centerBalcony.x, centerBalcony.y);
            
            // Railing
            ctx.strokeStyle = 'rgba(255, 42, 109, 0.5)';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 10; i++) {
                const x = 150 + (i * 50);
                const railTop = toIso(x, balconyY);
                const railBottom = toIso(x, balconyY + 30);
                ctx.beginPath();
                ctx.moveTo(railTop.x, railTop.y);
                ctx.lineTo(railBottom.x, railBottom.y);
                ctx.stroke();
            }
        }

        function drawMeetingTable() {
            const tablePos = toIso(meetingTable.x, meetingTable.y);
            
            // Table shadow
            ctx.fillStyle = 'rgba(0,0,0,0.3)';
            ctx.beginPath();
            ctx.ellipse(tablePos.x + 5, tablePos.y + 10, 70, 35, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Table top
            ctx.fillStyle = 'rgba(255, 107, 157, 0.25)';
            ctx.strokeStyle = '#ff6b9d';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.ellipse(tablePos.x, tablePos.y, 70, 35, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            
            // Table center
            ctx.fillStyle = 'rgba(255, 107, 157, 0.4)';
            ctx.beginPath();
            ctx.ellipse(tablePos.x, tablePos.y, 40, 20, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Table label
            ctx.fillStyle = '#ff6b9d';
            ctx.font = '9px "Press Start 2P"';
            ctx.textAlign = 'center';
            ctx.fillText('MEETING TABLE', tablePos.x, tablePos.y + 4);
        }

        function drawDesk(agent) {
            const pos = toIso(agent.x, agent.y);
            
            // Desk shadow
            ctx.fillStyle = 'rgba(0,0,0,0.3)';
            ctx.beginPath();
            ctx.ellipse(pos.x + 3, pos.y + 25, 22, 10, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Desk top
            ctx.fillStyle = 'rgba(0, 212, 255, 0.15)';
            ctx.strokeStyle = agent.color;
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.ellipse(pos.x, pos.y + 22, 22, 10, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            
            // Computer monitor (pixel style)
            ctx.fillStyle = '#1a1a2e';
            ctx.fillRect(pos.x - 10, pos.y + 5, 20, 15);
            ctx.strokeStyle = agent.color;
            ctx.lineWidth = 1;
            ctx.strokeRect(pos.x - 10, pos.y + 5, 20, 15);
            
            // Screen glow
            ctx.fillStyle = agent.color;
            ctx.globalAlpha = 0.4;
            ctx.fillRect(pos.x - 8, pos.y + 7, 16, 11);
            ctx.globalAlpha = 1;
            
            // Computer stand
            ctx.fillStyle = '#444';
            ctx.fillRect(pos.x - 2, pos.y + 20, 4, 4);
            
            // Desk label
            ctx.fillStyle = 'rgba(255,255,255,0.5)';
            ctx.font = '7px "VT323"';
            ctx.textAlign = 'center';
            ctx.fillText(agent.desk.substring(0, 15), pos.x, pos.y + 38);
        }

        function drawAgent(agent) {
            const pos = toIso(agent.x, agent.y);
            const bounce = Math.sin(Date.now() / 500 + agents.indexOf(agent)) * 1.5;
            
            // Shadow
            ctx.fillStyle = 'rgba(0,0,0,0.4)';
            ctx.beginPath();
            ctx.ellipse(pos.x, pos.y + 18, 10, 5, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Body (pixel style)
            const bodyY = pos.y + bounce;
            
            // Body block
            ctx.fillStyle = agent.color;
            ctx.fillRect(pos.x - 8, bodyY, 16, 16);
            
            // Body outline
            ctx.strokeStyle = 'rgba(255,255,255,0.3)';
            ctx.lineWidth = 1;
            ctx.strokeRect(pos.x - 8, bodyY, 16, 16);
            
            // Head
            ctx.fillStyle = '#f4e4c1';
            ctx.fillRect(pos.x - 6, bodyY - 10, 12, 10);
            
            // Head outline
            ctx.strokeStyle = 'rgba(0,0,0,0.3)';
            ctx.strokeRect(pos.x - 6, bodyY - 10, 12, 10);
            
            // Eyes
            ctx.fillStyle = '#000';
            ctx.fillRect(pos.x - 4, bodyY - 7, 2, 2);
            ctx.fillRect(pos.x + 2, bodyY - 7, 2, 2);
            
            // Status indicator (floating above head)
            const statusColor = agent.status === 'working' ? '#51cf66' : 
                               agent.status === 'busy' ? '#fcc419' : 
                               agent.status === 'meeting' ? '#ff6b9d' : '#666';
            ctx.fillStyle = statusColor;
            ctx.beginPath();
            ctx.arc(pos.x + 10, bodyY - 12, 3, 0, Math.PI * 2);
            ctx.fill();
            
            // Status glow for meeting
            if (agent.status === 'meeting') {
                ctx.fillStyle = 'rgba(255, 107, 157, 0.3)';
                ctx.beginPath();
                ctx.arc(pos.x + 10, bodyY - 12, 6, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // Name label
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 10px "VT323"';
            ctx.textAlign = 'center';
            ctx.fillText(agent.name, pos.x, bodyY + 28);
            
            // Activity label
            ctx.fillStyle = '#888';
            ctx.font = '8px "VT323"';
            ctx.fillText(agent.activity.substring(0, 18), pos.x, bodyY + 38);
        }

        function drawMeetingConnections() {
            const tablePos = toIso(meetingTable.x, meetingTable.y);
            
            agents.filter(a => a.status === 'meeting').forEach(agent => {
                const agentPos = toIso(agent.x, agent.y);
                
                ctx.strokeStyle = 'rgba(255, 107, 157, 0.25)';
                ctx.lineWidth = 1;
                ctx.setLineDash([4, 4]);
                ctx.beginPath();
                ctx.moveTo(agentPos.x, agentPos.y);
                ctx.lineTo(tablePos.x, tablePos.y);
                ctx.stroke();
                ctx.setLineDash([]);
            });
        }

        // Animation loop
        function animate() {
            drawOffice();
            requestAnimationFrame(animate);
        }
        animate();

        // Standup meeting
        const discussionTopics = [
            "How can we optimize API response times?",
            "What new features should we prioritize?",
            "Any blockers preventing task completion?",
            "Best practices for lead research?",
            "How to optimize token usage?",
            "Ideas for better dashboard UX?",
            "Partnership outreach strategies",
            "Code review feedback",
            "Design system improvements",
            "Automation opportunities",
            "Regional expansion ideas",
            "Customer feedback insights"
        ];

        function startStandup() {
            if (isStandupActive) return;
            
            isStandupActive = true;
            document.getElementById('standup-btn').disabled = true;
            document.getElementById('standup-btn').textContent = 'üé§ MEETING IN PROGRESS...';
            document.getElementById('meeting-status').classList.add('active');
            
            logActivity('üé§ STANDUP CALLED! All 20 agents gathering at meeting table...');
            
            // Move all agents to meeting table
            agents.forEach((agent, index) => {
                agentPositions[agent.id] = { x: agent.x, y: agent.y };
                
                const angle = (Math.PI * 2 / agents.length) * index;
                const radius = 90;
                
                agent.targetX = meetingTable.x + Math.cos(angle) * radius;
                agent.targetY = meetingTable.y + Math.sin(angle) * radius;
                agent.status = 'meeting';
                agent.activity = 'In standup';
                
                animateAgentToMeeting(agent);
                
                setTimeout(() => {
                    showSpeechBubble(agent);
                }, 2000 + (index * 600));
            });
            
            updateAgentList();
            showMeetingLog();
            
            // End after 3 minutes
            setTimeout(() => {
                endStandup();
            }, 180000);
        }

        function animateAgentToMeeting(agent) {
            const startX = agent.x;
            const startY = agent.y;
            const endX = agent.targetX;
            const endY = agent.targetY;
            const duration = 1500;
            const startTime = Date.now();
            
            function step() {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const ease = 1 - Math.pow(1 - progress, 3);
                
                agent.x = startX + (endX - startX) * ease;
                agent.y = startY + (endY - startY) * ease;
                
                if (progress < 1) {
                    requestAnimationFrame(step);
                }
            }
            step();
        }

        function showSpeechBubble(agent) {
            const topic = discussionTopics[Math.floor(Math.random() * discussionTopics.length)];
            const pos = toIso(agent.x, agent.y);
            
            const bubble = document.createElement('div');
            bubble.className = 'speech-bubble';
            bubble.style.left = (pos.x + canvas.parentElement.offsetLeft + 20) + 'px';
            bubble.style.top = (pos.y + canvas.parentElement.offsetTop - 50) + 'px';
            bubble.innerHTML = `<strong>${agent.name}:</strong> ${topic}`;
            
            document.body.appendChild(bubble);
            
            logActivity(`üí¨ ${agent.name}: "${topic.substring(0, 35)}..."`);
            
            setTimeout(() => bubble.remove(), 5000);
        }

        function endStandup() {
            logActivity('‚úÖ Standup complete! All 20 agents returning to fixed desks.');
            
            agents.forEach(agent => {
                const originalPos = agentPositions[agent.id];
                if (originalPos) {
                    animateAgentReturn(agent, originalPos);
                }
                agent.status = 'working';
                agent.activity = 'Working';
            });
            
            isStandupActive = false;
            document.getElementById('standup-btn').disabled = false;
            document.getElementById('standup-btn').textContent = 'üé§ CALL STANDUP';
            document.getElementById('meeting-status').classList.remove('active');
            document.getElementById('meeting-log').style.display = 'none';
            
            updateAgentList();
        }

        function animateAgentReturn(agent, targetPos) {
            const startX = agent.x;
            const startY = agent.y;
            const duration = 1500;
            const startTime = Date.now();
            
            function step() {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const ease = 1 - Math.pow(1 - progress, 3);
                
                agent.x = startX + (targetPos.x - startX) * ease;
                agent.y = startY + (targetPos.y - startY) * ease;
                
                if (progress < 1) {
                    requestAnimationFrame(step);
                }
            }
            step();
        }

        function showMeetingLog() {
            const log = document.getElementById('meeting-log');
            const topicsDiv = document.getElementById('meeting-topics');
            
            topicsDiv.innerHTML = discussionTopics.slice(0, 6).map(topic => 
                `<div class="meeting-topic">‚Ä¢ ${topic}</div>`
            ).join('');
            
            log.style.display = 'block';
        }

        // UI Functions
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
        }

        function logActivity(text) {
            const feed = document.getElementById('activity-feed');
            const time = new Date().toLocaleTimeString('en-US', { hour12: false });
            
            const item = document.createElement('div');
            item.className = 'activity-item';
            item.innerHTML = `
                <span class="activity-time">${time}</span>
                <span class="activity-text">${text}</span>
            `;
            
            feed.insertBefore(item, feed.firstChild);
            while (feed.children.length > 20) {
                feed.removeChild(feed.lastChild);
            }
        }

        function updateAgentList() {
            const list = document.getElementById('agent-list');
            list.innerHTML = agents.map(agent => `
                <div class="agent-status-item">
                    <span class="agent-emoji">${agent.emoji}</span>
                    <div class="agent-info">
                        <div class="agent-name" style="color: ${agent.color}">${agent.name}</div>
                        <div class="agent-task">${agent.desk} | ${agent.activity}</div>
                    </div>
                    <div class="status-dot ${agent.status}"></div>
                </div>
            `).join('');
        }

        function updateTime() {
            const now = new Date();
            document.getElementById('last-updated').textContent = 
                'Last updated: ' + now.toLocaleTimeString();
        }
        
        setInterval(updateTime, 1000);
        updateTime();
        updateAgentList();
    </script>
</body>
</html>
