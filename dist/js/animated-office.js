 class Agent {constructor(data) {this.id =data.id;this.name =data.name;this.role =data.role;this.emoji =data.emoji;this.color =data.color;this.department =data.department;this.x =data.position.x;this.y =data.position.y;this.targetX =data.target_position.x;this.targetY =data.target_position.y;this.status =data.status;this.activity =data.activity;this.speed =2;this.isMoving =false;this.direction =1;this.walkCycle =0;this.atMeetingTable =false;}update() {if (this.isMoving) {const dx =this.targetX-this.x;const dy =this.targetY-this.y;const distance =Math.sqrt(dx * dx+dy * dy);if (distance > this.speed) {this.x+=(dx / distance) * this.speed;this.y+=(dy / distance) * this.speed;this.direction =dx > 0 ? 1 :-1;this.walkCycle+=0.2;}else {this.x =this.targetX;this.y =this.targetY;this.isMoving =false;this.walkCycle =0;}}}moveTo(x,y) {this.targetX =x;this.targetY =y;this.isMoving =true;}goToMeetingTable() {const angle =Math.random() * Math.PI * 2;const radius =60;const tableX =500;const tableY =400;this.moveTo(tableX+Math.cos(angle) * radius,tableY+Math.sin(angle) * radius);this.atMeetingTable =true;}returnToDesk() {this.moveTo(this.targetX,this.targetY);this.atMeetingTable =false;}draw(ctx) {const legOffset =Math.sin(this.walkCycle) * 5;ctx.fillStyle ='#4a4a6a';if (this.isMoving) {ctx.fillRect(this.x-15+legOffset,this.y+30,8,20);ctx.fillRect(this.x+7-legOffset,this.y+30,8,20);}else {ctx.fillRect(this.x-15,this.y+30,8,20);ctx.fillRect(this.x+7,this.y+30,8,20);}const colors ={cyan: '#00ffff',pink: '#ff6b9d',green: '#51cf66',yellow: '#fcc419',purple: '#a855f7',orange: '#ff922b' };ctx.fillStyle =colors[this.color] || colors.cyan;ctx.fillRect(this.x-20,this.y-20,40,40);ctx.fillStyle ='#1a1a2e';ctx.fillRect(this.x-15,this.y-15,30,25);ctx.font ='16px Arial';ctx.textAlign ='center';ctx.fillText(this.emoji,this.x,this.y);const statusColors ={active: '#51cf66',busy: '#fcc419',offline: '#ff6b9d' };ctx.fillStyle =statusColors[this.status] || statusColors.active;ctx.beginPath();ctx.arc(this.x+15,this.y-15,5,0,Math.PI * 2);ctx.fill();ctx.fillStyle ='#fff';ctx.font ='10px "Press Start 2P"';ctx.fillText(this.name,this.x,this.y+55);}}class Office {constructor(canvas) {this.canvas =canvas;this.ctx =canvas.getContext('2d');this.agents =[];this.meetingTable ={x: 500,y: 400,radius: 80 };this.conversations =[];this.logs =[];this.loadAgents();this.setupEventListeners();this.startSimulation();}async loadAgents() {try {const response =await fetch('/data/agents.json');const data =await response.json();Object.values(data.agents).forEach(agentData => {this.agents.push(new Agent(agentData));});this.log('Office initialized with '+this.agents.length+' agents');}catch (error) {console.error('Failed to load agents:',error);this.log('Error loading agents: '+error.message,'error');}}setupEventListeners() {this.canvas.addEventListener('click',(e) => {const rect =this.canvas.getBoundingClientRect();const x =e.clientX-rect.left;const y =e.clientY-rect.top;const dx =x-this.meetingTable.x;const dy =y-this.meetingTable.y;const distance =Math.sqrt(dx * dx+dy * dy);if (distance < this.meetingTable.radius) {this.callMeeting();}});}callMeeting() {this.log('Meeting called at the table');const meetingSize =Math.floor(Math.random() * 3)+2;const participants =[];for (let i =0;i < meetingSize;i++) {const randomAgent =this.agents[Math.floor(Math.random() * this.agents.length)];if (!participants.includes(randomAgent)) {participants.push(randomAgent);randomAgent.goToMeetingTable();}}const conversation ={id: Date.now(),participants: participants.map(a => a.name),startTime: new Date().toISOString(),topic: this.generateTopic(participants),status: 'ongoing' };this.conversations.push(conversation);this.log(`${participants.map(a => a.name).join(',')}started a meeting about ${conversation.topic}`);setTimeout(() => {this.endMeeting(participants,conversation);},5000+Math.random() * 5000);}generateTopic(participants) {const topics =[ 'API integration','Dashboard design','Lead generation strategy','Content calendar','Security review','Performance optimization','Partnership outreach','System monitoring' ];return topics[Math.floor(Math.random() * topics.length)];}endMeeting(participants,conversation) {participants.forEach(agent => {agent.returnToDesk();});conversation.status ='completed';conversation.endTime =new Date().toISOString();this.log(`Meeting completed: ${conversation.topic}`);}log(message,type ='info') {const logEntry ={timestamp: new Date().toISOString(),message,type };this.logs.push(logEntry);if (this.logs.length > 100) {this.logs.shift();}this.updateLogsDisplay();}updateLogsDisplay() {const logsContainer =document.getElementById('office-logs');if (logsContainer) {logsContainer.innerHTML =this.logs .slice(-20) .map(log => ` <div class="log-entry ${log.type}"> <span class="log-time">${new Date(log.timestamp).toLocaleTimeString()}</span> <span class="log-message">${log.message}</span> </div> `) .join('');}}drawOffice() {this.ctx.fillStyle ='#2d1b4e';this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);this.ctx.strokeStyle ='rgba(255,255,255,0.05)';this.ctx.lineWidth =1;for (let x =0;x < this.canvas.width;x+=50) {this.ctx.beginPath();this.ctx.moveTo(x,0);this.ctx.lineTo(x,this.canvas.height);this.ctx.stroke();}for (let y =0;y < this.canvas.height;y+=50) {this.ctx.beginPath();this.ctx.moveTo(0,y);this.ctx.lineTo(this.canvas.width,y);this.ctx.stroke();}this.ctx.fillStyle ='rgba(244,228,193,0.3)';this.ctx.beginPath();this.ctx.arc(this.meetingTable.x,this.meetingTable.y,this.meetingTable.radius,0,Math.PI * 2);this.ctx.fill();this.ctx.strokeStyle ='#f4e4c1';this.ctx.lineWidth =3;this.ctx.stroke();this.ctx.fillStyle ='#f4e4c1';this.ctx.font ='12px "Press Start 2P"';this.ctx.textAlign ='center';this.ctx.fillText('MEETING TABLE',this.meetingTable.x,this.meetingTable.y);this.drawDepartmentArea('EXECUTIVE',400,100,200,100,'#ff6b9d');this.drawDepartmentArea('DEV',150,300,400,100,'#ff922b');this.drawDepartmentArea('CONTENT',150,500,250,100,'#00ffff');this.drawDepartmentArea('GROWTH',600,500,250,100,'#51cf66');this.drawDepartmentArea('OPS',150,700,400,100,'#fcc419');this.drawDepartmentArea('BD',600,700,400,100,'#a855f7');}drawDepartmentArea(name,x,y,width,height,color) {this.ctx.strokeStyle =color;this.ctx.lineWidth =2;this.ctx.strokeRect(x-10,y-10,width+20,height+20);this.ctx.fillStyle =color;this.ctx.font ='10px "Press Start 2P"';this.ctx.textAlign ='left';this.ctx.fillText(name,x,y-15);}update() {this.agents.forEach(agent => agent.update());}draw() {this.drawOffice();this.agents.forEach(agent => agent.draw(this.ctx));}startSimulation() {const loop =() => {this.update();this.draw();requestAnimationFrame(loop);};loop();setInterval(() => {const randomAgent =this.agents[Math.floor(Math.random() * this.agents.length)];if (!randomAgent.isMoving && !randomAgent.atMeetingTable) {const offsetX =(Math.random()-0.5) * 100;const offsetY =(Math.random()-0.5) * 50;randomAgent.moveTo(randomAgent.targetX+offsetX,randomAgent.targetY+offsetY);}},3000);setInterval(() => {if (Math.random() < 0.3) {this.callMeeting();}},10000);}}window.addEventListener('load',() => {const canvas =document.getElementById('office-canvas');if (canvas) {canvas.width =1000;canvas.height =800;window.office =new Office(canvas);}});